<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>flowee</title>
<link rel="stylesheet" href="css/air.css">
</head>
<body>

<a href="https://github.com/coderofsalvation/flowee#readme"><img style="max-width:none; position: absolute; top: 0; left: 0; border: 0;border-radius:0; height:auto;width:auto;" src="https://camo.githubusercontent.com/8b6b8ccc6da3aa5722903da7b58eb5ab1081adee/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f6c6566745f6f72616e67655f6666373630302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_left_orange_ff7600.png"></a>
## Data logic / Permissions / Authentication 

Database access can be supervised by introducing [fortunejs transformers](http://fortunejs.com/api/):

    const errors = fortune.errors

    store.transformOutput(type, (context, record) => {
      if (context.request.meta['Authorization'] !== 'secret')
        throw new errors.UnauthorizedError('Not allowed to view this resource.')

      return record
    })

In a similar way this can be done with custom endpoints by introducing authentication middleware __before__ flowee 
is started.
For example using [rest-auth](https://www.npmjs.com/package/rest-auth):

    var auth = require('rest-auth');
 
    // Tell the auth module how to authenticate a user 
    auth.authenticateUser(function(username, password, callback) {
        /* TODO: use nedb in example, not mongodb */
        User.findOne({ username: username }, function(err, user) {
            if (err) {
                return callback(err);
            }
            if (! user) {
                return callback(null, false, 'User does not exists');
            }
            if (hash(password) !== user.password) {
                return callback(null, false, 'Invalid password');
            }
            // The username and password should be given here 
            callback(null, {
                username: username,
                password: user.password
            });
        });
    });:

    flowee.use(auth.authenticate({
        expires: '2 hours',
        authRoute: 'auth-token',
        authTokenHash: {
            algorithm: 'sha256',
            salt: 'saltiness'
        }
    });
  
    flowee.start(model, function(server, router) {
      ..
<hr>
<center>
  generated at Tue Dec 15 15:04:36 CET 2015
</center>
</body>
</html>